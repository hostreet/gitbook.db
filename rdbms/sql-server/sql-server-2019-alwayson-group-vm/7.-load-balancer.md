---
description: Azure Load Balancer 생성 및 구성
---

# 7. Load Balancer 구성

## Azure Load Balancer 생성 

먼저 SQLVM-PRIMARY와 SQLVM-SECONDARY 서버에서 접속 테스트 

![](../../../.gitbook/assets/loadbalancer_set.png)

{% hint style="info" %}
 SQLVM-PRIMARY서버에서는 클러스터 IP\(10.0.1.6\)와 리스너 IP\(10.0.1.100\)가  LB 구성없이   
접속이 잘 되지만, SQLVM-SECONDARY 서버에서는 접속이 안
{% endhint %}

Azure Portal 접속 후 LB 생성 

![](../../../.gitbook/assets/loadbalancer_set2.png)

{% hint style="info" %}
LB 생성시 SKU는 PIP의 SKU와 동일해야 해서 PIP와 같은 표준으로 생성
{% endhint %}

### LB의 Basic, Standard SKU 테스트 

![](../../../.gitbook/assets/loadbalancer_set3.png)

{% hint style="info" %}
PIP와 같은 SKU인 표준으로 생성시 백엔드 풀에 가상 머신이 정상적으로 출력
{% endhint %}

![](../../../.gitbook/assets/loadbalancer_set4.png)

{% hint style="info" %}
PIP와 다른 SKU인 기본으로 생성시 백엔트 풀에 가상 머신이 없다고 출력
{% endhint %}

프런트 엔드는 LB 생성시 입력한 리스너 IP로 생성되어 있음 

![](../../../.gitbook/assets/loadbalancer_set7.png)

SQLVM-PRIMARY, SQLVM-SECONDARY 가상머신 백엔드 풀 추가 

![](../../../.gitbook/assets/loadbalancer_set5.png)

상태 프로브 설정 포트 59999

![](../../../.gitbook/assets/loadbalancer_set6.png)

부하 분산 규칙 추가 

![](../../../.gitbook/assets/loadbalancer_set8.png)

클러스터 IP에 대해 프런트 엔드 IP 추가

![](../../../.gitbook/assets/loadbalancer_set9.png)

상태 프로브 포트 추가 

![](../../../.gitbook/assets/loadbalancer_set10.png)

클러스터 IP 부하 분산 규칙 추가 

![](../../../.gitbook/assets/loadbalancer_set11.png)

SQLVM-PRIMARY, SQLVM-SECONDARY 새로 추가된 포트 58888 방화벽 오픈 

![](../../../.gitbook/assets/loadbalancer_set12.png)



